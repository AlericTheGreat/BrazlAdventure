define(["require","exports","tslib","react","classnames","spectrum/checkbox","spectrum/tertiary_link","spectrum_comments/comment","spectrum_comments/thread/thread_editor"],function(e,t,n,o,r,i,s,a,c){"use strict";function d(e){var t=e.count,n=t>1?t+" comments":t+" comment";return o.createElement("div",{className:"sc-thread-comment-number"},n)}function m(e,t){return{onDeleted:function(){return t.onCommentDeleted(e.id)},onEdited:function(n){return t.onCommentEdited(e.id,n)},onMentionsQueryUpdated:t.onMentionsQueryUpdated,onClickTimeCode:t.onClickTimeCode}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){},u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isEditorEmpty:!0},t.onEditorCancel=function(){t.props.onEndEdit()},t.onEditorContentChange=function(e){var n=e.isEmpty;e.isFocused&&t.props.actions.onEditorFocused(),t.setState({isEditorEmpty:n})},t.onEditorPost=t.props.actions.onReply,t.onMentionsQueryUpdated=t.props.actions.onMentionsQueryUpdated,t}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.active&&this.ref&&this.ref.scrollIntoView()},Object.defineProperty(t.prototype,"active",{get:function(){return this.props.active||!this.state.isEditorEmpty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){var e=this.props,t=e.className,n=void 0===t?"":t,o=e.thread;return r(n,{"sc-thread":!0,"sc-thread-active":this.active,"sc-thread-inactive":!this.active,"sc-thread-read":o.read,"sc-thread-unread":!o.read,"sc-thread-resolved":o.resolved,"sc-thread-unresolved":!o.resolved})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filteredReplies",{get:function(){var e=this.props.thread.comments;e[0];return e.slice(1).filter(function(e){return!e.deleted})},enumerable:!0,configurable:!0}),t.prototype.renderComment=function(e,t,n,r){void 0===n&&(n=a.Comment);var i=this.props,s=i.actions,c=i.editedComment,d=i.mentionsMatches,l=(i.onStartEdit,i.onEndEdit,!!c&&e.id===c.id);return o.createElement(n,{actions:m(e,s),active:t,annotation:r,comment:e,key:e.id,isEditing:l,onStartEdit:this.props.onStartEdit,onEndEdit:this.props.onEndEdit,mentionsMatches:d})},t.prototype.renderResolveControl=function(){var e=this.props,t=e.actions,n=e.thread,r=n.resolved?"Resolved":"Resolve",s=n.resolved?o.createElement(i.Checkbox,{checked:"checked",onChange:function(){return t.onUnresolve()}}):o.createElement(i.Checkbox,{checked:"unchecked",onChange:function(){return t.onResolve()}});return o.createElement("label",{className:"sc-thread-controls-resolve"},s,r)},t.prototype.renderReadToggle=function(){var e=this.props,t=e.actions,n=e.thread,r=n.read?t.onMarkAsUnread:t.onMarkAsRead,i=n.read?"Mark as unread":"Mark as read";return o.createElement(s.TertiaryLink,{className:"sc-thread-read-toggle",onClick:r},i)},t.prototype.renderActive=function(){var e=this,t=this.props,n=(t.actions,t.commentComponent),r=t.mentionsMatches,i=t.thread,s=t.user,d=this.filteredReplies;return o.createElement("li",{className:this.className,ref:function(t){return e.ref=t}},o.createElement("div",{className:"sc-thread-controls"},this.renderResolveControl(),this.renderReadToggle()),o.createElement("ul",{className:"sc-thread-comments"},this.renderComment(i.comments[0],this.active,n,i.annotation),d.map(function(t){return e.renderComment(t,!0,a.Comment)})),o.createElement(c.ThreadEditor,{author:s,mentionsMatches:r,onCancel:this.onEditorCancel,onContentChange:this.onEditorContentChange,onMentionsQueryUpdated:this.onMentionsQueryUpdated,onPost:this.onEditorPost}))},t.prototype.renderInactive=function(){var e=this.props,t=e.active,n=e.commentComponent,r=void 0===n?a.Comment:n,i=e.mentionsMatches,s=e.onActivated,c=e.thread,m=this.filteredReplies;return o.createElement("li",{className:this.className,tabIndex:0,onClick:s},o.createElement("ul",{className:"sc-thread-comments"},this.renderComment(c.comments[0],t,r,c.annotation),m.length>1&&o.createElement(d,{count:m.length-1}),m.length>0&&o.createElement(a.Comment,{active:!1,comment:m[m.length-1],actions:{onClickTimeCode:l,onDeleted:l,onEdited:l,onMentionsQueryUpdated:l},mentionsMatches:i,onEndEdit:l,onStartEdit:l,isEditing:!1})))},t.prototype.render=function(){return this.props.thread.comments.every(function(e){return!!e.deleted})?null:this.active?this.renderActive():this.renderInactive()},t})(o.PureComponent);t.Thread=u});
//# sourceMappingURL=thread.min.js-vflt99Q4h.map