define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify"],function(e,o,r,n,t,i,a,s,l,d,u,c){"use strict";function p(e){var o=e.file,r=e.sharedLink;return A(e)?P(o)?r?N.Button:N.Dropdown:N.Ellipsis:N.Off}function _(e){return e===N.Dropdown||e===N.Ellipsis?u.BubbleDropdownPositions.BOTTOM_LEFT:u.BubbleDropdownPositions.BOTTOM}function f(){return"ON"===i.EMBED_TO_PAPER_ONBOARDING_VARIANT}function A(e){var o=e.file,r=e.user,t=e.sharedLink;return!!o&&((P(o)&&g.includes(i.OPEN_IN_PAPER_VARIANT)||h(o)&&k.includes(i.EMBED_TO_PAPER_VARIANT))&&!s.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!r&&!!t||!!r&&!r.is_paper_disabled))}function h(e){var o=a.getExtension(e);return!!o&&C.includes(o)}function P(e){var o=a.getExtension(e);return!!o&&(E.includes(o)&&e.bytes<20971520)}function b(e){var o=d._("Copy to Paper");return h(e)&&(o=d._("Add to Paper doc")),o}function T(e){return h(e)}function m(e){if(h(e))return d._("Bring it all together");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return d._("Plan your next steps");case"VARIANT_2":return d._("Bring it all together")}return d._("Bring this doc to life")}function I(e){if(h(e))return d._("Add this file to a Paper doc to collect ideas and organize your thoughts.");switch(i.OPEN_IN_PAPER_CALLOUT_VARIANT){case"VARIANT_1":return d._("Copy to Paper for the ability to create and assign to-dos with due dates.");case"VARIANT_2":return d._("Copy to Paper to make this a doc where you can link other files and media.")}return d._("Copy to Paper and make changes or ask for feedback.")}function O(e){var o=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,a=e.errorCallback,s=e.extension,l=e._tk,d=e.oqa,u=e.fromModal;r.WebRequest({url:"/paper/sign_request_data",data:{path:o.file_id,sharedLink:n,cont_url:t,extension:s,_tk:l,oqa:d,fromModal:u},success:i,error:a})}function w(e){var o=window.open("","_blank"),r=function(e){o?n.redirect(e,o):n.redirect(e)},i=function(){o&&o.close(),c.Notify.error(d._("Canâ€™t copy file to Paper"))},s=e.sharedLink?e.sharedLink:"",u=e.file,p=e.user,_=e.fromModal,f=e.sharedLink?"shared_file_actions":"mounted_file_actions",A=a.getExtension(u);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:f,cta:"open_in_paper_button",extension:A});var h=A,b={file:u,sharedLink:s,contUrl:"/create-doc-from-dropbox-file",extension:A,successCallback:r,errorCallback:i,_tk:"dropbox_web_copy_from_previews",oqa:h,fromModal:_};if(P(u))O(b);else if(b._tk="dropbox_web_embed_from_previews",!s&&p){var T=new t.FileShareApiClient({userId:p.id});T.sharedLinkInfo({fileIdOrPath:u.file_id}).then(function(e){e?(b.sharedLink=e.url,b.contUrl="/dropbox-file-embed",O(b)):T.createSharedLink({fileIdOrPath:u.file_id}).then(function(e){b.sharedLink=e.url,b.contUrl="/dropbox-file-embed",O(b)}).catch(function(e){i&&i()})}).catch(function(e){i&&i()})}else b.contUrl="/dropbox-file-embed",O(b)}Object.defineProperty(o,"__esModule",{value:!0});var N,g=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],k=["BUTTON","DROPDOWN","ELLIPSIS"],E=["docx"],C=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(N=o.OpenInPaperButtonVariant||(o.OpenInPaperButtonVariant={})),o.getOpenInPaperButtonVariant=p,o.getCalloutPosition=_,o.shouldShowEmbedToPaperModal=f,o.shouldShowOpenInPaper=A,o.fileSupportsEmbedToPaper=h,o.fileSupportsCopyToPaper=P,o.getCTAText=b,o.shouldShowCTADescription=T,o.getCalloutTitle=m,o.getCalloutMessage=I,o.createPaperAccountAndRedirect=O,o.openFileInPaper=w});
//# sourceMappingURL=utils.min.js-vfl9KmnwZ.map